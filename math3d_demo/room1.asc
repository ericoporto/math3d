// room script file
Transform3D cam;


function room_AfterFadeIn()
{
  Matrix* m = Matrix.CreateFromString("{{2, 3, 6},{8, 5, 7}}");
  
  Display(m.AsString);
}

void UpdateCameraTransform(){
  Vec3* v3pos = Vec3.Create(20.0*IntToFloat(sld_cam_x.Value-500)/500.0, 20.0*IntToFloat(sld_cam_y.Value-500)/500.0, IntToFloat(sld_cam_z.Value-500));
  Vec3* v3scale = Vec3.Create(2.0*IntToFloat(sld_cam_sx.Value)/1000.0, 2.0*IntToFloat(sld_cam_sy.Value)/1000.0, 2.0*IntToFloat(sld_cam_sz.Value)/1000.0);
  Vec3* v3rot = Vec3.Create(Maths.Pi*IntToFloat(sld_cam_rx.Value-500)/500.0,  Maths.Pi*IntToFloat(sld_cam_ry.Value-500)/500.0, Maths.Pi*IntToFloat(sld_cam_rz.Value-500)/500.0);
  
  cam.SetCameraTransform(v3pos, v3scale, v3rot);
}

void on_call(int n){
  if(n >= 990 && n<999){
    UpdateCameraTransform();
  }  
}

function room_Load()
{
  sld_cam_x.Min = 0;
  sld_cam_x.Value = 500;
  sld_cam_x.Max = 1000;
    
  sld_cam_y.Min = 0;
  sld_cam_y.Value = 500;
  sld_cam_y.Max = 1000;
  
  sld_cam_z.Min = 0;
  sld_cam_z.Value = 500;
  sld_cam_z.Max = 1000;

  sld_cam_sx.Min = 1;
  sld_cam_sx.Value = 500;
  sld_cam_sx.Max = 1000;
    
  sld_cam_sy.Min = 1;
  sld_cam_sy.Value = 500;
  sld_cam_sy.Max = 1000;
  
  sld_cam_sz.Min = 1;
  sld_cam_sz.Value = 500;
  sld_cam_sz.Max = 1000;

  sld_cam_rx.Min = 0;
  sld_cam_rx.Value = 1000;
  sld_cam_rx.Max = 1000;
    
  sld_cam_ry.Min = 0;
  sld_cam_ry.Value = 500;
  sld_cam_ry.Max = 1000;
  
  sld_cam_rz.Min = 0;
  sld_cam_rz.Value = 1000;
  sld_cam_rz.Max = 1000;
  
  cam.Init();
  cam.SetSurfaceSize(320.0, 180.0);
  cam.SetPosition(0, 0, 320, 180);
  cam.SetPerspectiveProjection(60.0, 1.0, 1000.0);
  
  cam.SetCameraTransform(
    Vec3.Create(20.0, 20.0, 500.0), 
    Vec3.Create(1.0, 1.0, 1.0), 
    Vec3.Create(Maths.Pi, 0.001, Maths.Pi));
  
}
